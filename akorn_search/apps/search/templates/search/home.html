{% extends 'page.html' %}
{% load search_filters %}

{% block scripts %}
{{ block.super }}
<script src="{{ STATIC_URL }}search/js/json2.js"></script>
<script src="{{ STATIC_URL }}search/js/tag-it.js"></script>
<script src="{{ STATIC_URL }}search/js/main.js"></script>
<script type="text/javascript">
{% if last_visit %}
// TODO There is probably a better way to do this
akorn.last_visit = "{{ last_visit|date:"c" }}";
{% endif %}
// When the document has loaded start the show
$(document).ready(akorn.init);
</script>
{% endblock %}

{% block content %}
<div class="row-fluid">
    <div class="span12 search">
        <form action="/search/" method="get" class="form-inline">
            <input type="text" name="q" placeholder="Search" id="search"><button id="save_search" class="btn btn-primary" disabled="disabled" title="Save this search">Add <i class="icon-ok icon-white"></i></button>
        </form>
        <hr />
    </div>
</div>

<div class="row-fluid">
    <div class="span9 articles">
        <ul id="latest_articles">
        </ul>
    </div>
</div>

<div class="span3">
<ul id="saved_searches" class="nav nav-tabs nav-stacked">
    {% for q_id, q in saved_searches.items %}
        {% spaceless %}
        <li>
        <div class="tools">
            {% if q.count > 0 %}
            <span class="badge badge-important">{{ q.count }}</span>
            {% endif %}
            <i data-queryid="{{ q_id }}" class="delete icon-trash"></i>
        </div>
        <a id="{{ q_id }}" data-query="{{ q.queries|to_json|escapejs }}">{{ q|short_label }}</a>
        </li>
        {% endspaceless %}
    {% endfor %}
</ul>
</div>
{% endblock %}
